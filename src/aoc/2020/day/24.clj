(ns aoc.2020.day.24
  (:require [clojure.string :as s]))

(defn ->dirs [input]
  (->> input
       (s/split-lines)
       (map #(re-seq #"e|w|nw|ne|sw|se" %))))

(def input "enesenwwwsenewswsewenwwnwwnwnwswse\nswneswseesweswneswwwwseewnewswsw\nneneenenenenwneseneesenewenenwnenenesw\nweeswnenenwneneeesweneswenwneene\nnwnwnenwnwwnwnwnwnwwsewnwswnwwnwnwnw\nnwwwnwnwnenenwewnwseewnwswnwwnww\nsenwweneewewswweswsenwnesenwwnwswnw\nnwnwnenenenenwnesenenenwneswnwnweeswwsene\nwswnwswneneswswswswswnesweseswwswnwswsw\nneeeeeweseesesweeneweneesw\nwwenewwwwwwnwnwwwwwwwwse\nswneswswseseswswswsw\nseswswsewseesesese\nnenwneneneewseneneneenenenenenesenenew\nswswwwnewwsewwwswwwswswwnesew\nwwswwwwwwwwwwwswewwwwe\nsenewnwwnwswnwswnwewnenwenwewsenwnwse\nwnwnwenwwnwnwwnewnwswsenwnwnwnwwne\nnenwneswnwnwswnwnwesewwnwnwnwsenwnene\nwsewneeseneseseseswnesesenwswenwswnwe\nnesewnwwwswnweneenwswwesenesw\nswsesenwswsesesewswswneseseeswnesesesewsw\nneneswswwswswwswseswswewwswswswsew\neeeneeneneneneesweenewneneeee\nseeenesesweseeeewwneeseeseee\nnweeweeneeswenewe\nseswwnwseeswseseswswe\nwneneeswnesenwseneeneneneenwneneneenwne\nnewnenesenenenenenewneswnenenenenenenenese\nwswswswswwswwwwweswnwswsewswswsw\neeeeeenesenwewseeneeneneweee\nsewnwwnwnwwwnwnwnwnwswwwewnwww\nsewesenwswwneswnwnwnwsweseseeswwse\nnwwewnwweswswwwwewnwnwnwwnwwswe\nswwwswnwswswenwneswswseswsweswseswsene\neneeenwswseseeeeeesenwenwwsweee\nswseenwseesewnwnewnwneeeswswesenee\nswwsesenwnwnwwwwnewenwnwewwwwsw\nseeeeeeeeswnweeenwnwnewswesw\nseenwswnenenwnewnwnwnwnwe\nesenenweeswseeeseeweseseeeee\nswswswswseswswswswnenw\nneneseswsenenewneenenewwnenenenenenenene\nwnewwenweswswwwswseswswwwnesene\nseneneneweenwnwseeeweeseseeeene\nneenwsweneneeeswwnwwneeenewnene\nseseneswwneswseswwsesenwseseseswsesese\nwweeeeeeswsenweeneeee\nnewnenenwneseneneeneeneneseneneeneene\nwewnwnwwwwwwsenewnwwnwnwwwse\nweseeseseswnwsewseneneeeesewwe\nswswswswswswswswswswswwneswswwwswswe\nswsenwneeseswseswswswswseseneseswswswsw\nseswnenwwswswswneswsewwnewseswswwwsw\nswswswneswswseswnwswseswseswswseneseswsw\nwwwwnewesesewswwwnewwwne\nenweeneseneeeeswnwesw\neesesenwseseeseseesesese\nnwswseenesewwseesenee\nwwswswswwswswwneesw\nnewwseswwnewswwwwswnwewnewwsww\nnesenenenewenesenenenenwnwswnenwnwnenene\nswnwswswneswswneswswswswseswswseswsweswwsw\nswswswswswswneseswswseswnwswswswsweswsw\nnwwwwswwwsewwwwewnwewswwww\nneneeneeewneeneeeneenene\nswnwnwnwneswwwseeenewnewswsenwwnww\nnenenenwnenwneswnenwnenenenenene\nnwweenwesweeeeeeseeeeewnenese\nweeeneeseeeseeeseeeewe\nwwwwwnwesewwwswewwwwenww\nseneseseseseseneswsesesesewsewsesesese\neenwneneseeeeeesweenweeeenee\nneseneseseseseseeseswseeeeseewee\nnwswnweeeeseeseneeneneswswneneee\nsesesewseseswesesesewseeneeseesese\nseswnewwswewnwswneneswwnwnwnew\nwneseneeeewsesewneneneenenwswnwne\nwnwnenwnwnwnwsenenwnesenwnwnwnwnwnwnwnwwnw\nwwnewnwwswweswewswseeewenwsw\neneeneseeneneneewneweeeneeeneew\nnwwnwnwwnwnwenenwnwnwenwnenwnenwnenw\nnwsenwnwenwnwswsenwsenwnwnwnwnwnwswenwnw\neeseseeeeeseseeeneesenwseeswe\newenewneeneswewneseneswsewswwese\nnwwwwswwswswwse\nnewnwnwnwwwwnwnwswsewewnwwwwnwnw\nseswswnwwseseseswseesw\nsewseweswwwwwswwwwwswwwwnwne\nsenenenenwnwnwnwnwnwnwnwnw\nswswswwwwswswwnwwwswwesewwww\nseeneseseneseesesesewsesesesesenwseswsw\nwnenwnwsewwwnwnwwwwwsewwnwnew\nswswswswswneswseswswswseseseswswnwsesese\nneneneneneeneenenesenenwnenewnesenenee\nwseseswseneeseswneseswseswswwwseswne\nnenenenenenenwnenenenesenesewswneneenwe\nseeseseseeseneesesenweeewseewsese\nneeewneneneneseneenenenenenenesenwne\nnenewnweneweseenwnwsesewnwswnwnwnw\nsewnwnesenenwneswwnenwnwnwsenweneswe\nsenwnwnenwswnwnwnwnenwenenwnwnenenesenw\nwnwwwwwsewnwwwewwwweseww\nswnwnewnwnwsenwsenwnwnwnenwneswwwnwenenw\nwnwseswnewwweewneneeseseesenww\nwseseseseeseseseseseesesesenwswswswnw\nneneneneneneneseneswnenenwneneneneneenewne\nneswswswswswswsesesesesewsewneswsenesw\nnenwneswnwweseeenwnesweneeneeese\nseesesesesesweeseseseesweenweseenwse\nseeswseseseswseseseswswswnenwswswseswsw\nswneswswseswswswwswswnwswseswswswswseneswsw\nnwseseesesewneeseseeeeeseewenesese\nnenenenewneneswneswneneswswneneneneene\nnwswnwnenwnwnwnwswnewnwnwnwenwnwnwnww\nnwwnwnwnwnenwnwnenwsenenwnenwnwnwnwnw\nsenenenwnwewwwneeneewnenwsew\nnenenenwneneneneswneneneeswenenenwnenw\nwwneweewseswseseneneeseeeseese\nneneneeswnenenewneneneneneneswenenene\neeeeewseeeneneneeeeeweenwsw\nnwenenwnwswwsenwnwswneswnwnwnenwenenwne\neswwswneswswswswswnwewswswwswswwswswsw\nenwwwwnwnwnwwewwnwnwnwnwseeww\nseseseneeseseseseneseseewwseesesesese\nnenenweneswnewenw\nnenenenwneneneseswnwnwsenwenwewnenenwnw\nnenenenwnwnwenwnwswnwnwwnwnwnwnwnwsenw\nneeneneneeneneneneneneenesw\nneeeneeeswnwnenwsewswswnenwsenwnee\nwenwwwswenewwwsewswswnewswwew\nseseeneeseseseneseseesesewsesewsesesese\nswewnwwsenwnwwseewwnwwwnewwnw\nwesesweeneeenewnwsweenenwneeesw\nnwnwswnwnwnwnwnwenenwnwswnwnwnwnwnwenenw\nnwsenwwswnenwneeesenewenwwwnw\newseeeeenweseseseeeewseeseese\nwnwnwsewwnwneswwnwwnwnwwnwwwnwnenw\nswswsenwwswwenenenewseswswewswnesw\nwnwswsesesesweeswseswswswswswseswswsw\neneeswnwwnwnwsweenwenwnwnewnwswswnwne\nseseswswseseswseswsenesesewsenenwsesww\neeeneswnwnwnwneneseneseneenewnenwsee\nenweseesweswneeweseenwneeew\nnewneneneneeneneswsenenewnenenene\neneswwneneenwnenesenewwnenenesenene\nswswswswswsesenwswswswswsw\neeeneewewneeeee\nswswsesenwswsenwswseswsweswseswnwseswswenw\nsweneseswswesenenenwnwwnwnwneswe\nwnwnwnwwwwsweneswnwnwnwewwnwww\nseseswswswsesenwwseeseswswswswweese\nseseeseseseseesesesenwnenwsenwsesesesew\nwnwnwswnwwwwwwsewwwnenwwwwe\nwnwwsenwneewswnwsenwnenwwnwesenwnewsw\nswnenwnenenwnwwnwnesenenwnwnenwnenenenwnw\nwwewwwwnwswwwnewwwswwwwnw\nneneeeweesesenweneneswneeeewne\nswswswseneneswwseseseneseseseswswswswswsw\nnwnwnenwswwnwwwwnwwwwsew\nswswswswseswsesesenwswsewseseswswesesw\nnenwswnwnenwswnenwnwnenwnwnwsenwnwneenw\nwseseswswswneseswseseswswsenwswswne\nswnesesewseneseswswnwswswswswnwswseswswswsw\nwnwnwnwnenwsenwneenwswnwnwnwenwsenwswnw\nenenenewnenenwnenenenwnenenenenw\nenenwnenwsewwwsweenenewnwnenwene\nswwswsewnewswneswswwwswswwswwswwsw\nneneswseeneeswewenwwswswweesese\nswnwseswsenwsenweewenwsweeneeese\nnwenwnwnwnwswnwnenwnwnwnwnwnwnwnwwsenw\nseseseseeseseseeeeewesenesesewe\neswsenwnwneswwswwswnwwwwseeswsenwe\nenenewnesenewnwnwnwswnwnwnenesenenwnenw\nwneneneeneeeeweenewnenesweesene\nenewnweneneeneeeswneneeeeenene\nnwswsesenwnenwnwwnwnweswswnwnwneeew\neseeewneeneeeeeneeeeeseewene\nsewnewwwwwwwsewwwwwwwnwwe\nnewnenesenweneneneweneenene\nswseswswswswswswswswewswswswswswnwneswswsw\neseneneseseeseseeeeseeeeeswsewse\nenwneenenewneeneneneswnenenenenenene\nnenenwnenenwseneneenwnwnenwnweswnwnww\nnwnwenwnwsenwnwnwnwnwwwse\nnweswswwswenenweeeseseseeeeeee\nnwnenwswnwwnwenwsewwnwneswnwnwnwnwsee\nseeseeseseneewswweseseswswwwswswsw\nnwnwnesenwenwnwnwnwnwnwwnwneswnwswwnwnw\nseseseseswseswesesesesesesenesewswsenw\nswswwswseseseseswsewseseneseseswneswswsw\nnwnwnwnenwswnwnwnenesenenwnwnenwnwnwnenw\nswnewwnwneenwnwenwsenwnwnwsewnwenw\neeenwwweeeewseneeswesenese\nswenewneseneswneenwnesenenenwnenewene\nnwnenwwwwwnewwwwwwwsesenwwww\nseseswneseseseeenewwsese\nenwneeeswenewneeeeneeseneeee\nseseeseneseeeeeeswwnenwseswsesese\nnwnesesenenenwnwnenwnwnenenwnewnwnwnenw\nwwswnwnwewewswneseeswswswseneswsw\nnwsenwneneneneneneeseewnenenenenesenwse\nnesewswswneneswneswseswswnewswswsenese\nswswwsesweswnwseseswseseswseseseseswsw\nsenenwswenwnwnwwnenwsenwnwnwnenwewnwwnw\nnenenenwnwneswswneswnenenenenenenenenene\nenweneswneneneeswneneeewneenenee\nnwnwswnwwnwseesenenwwswwnewwsenwnwnw\nneswseseswneeswneneswswneswenwwswwwe\nswwneeneeneswwewnwneseeenwnenwnewne\nwswwwseenwnewneswwnwwwnwseew\nseewwnenenwneswwnenwneseneenenenene\nswwsenwswsweseesenwwwswswwnewnesenew\nneswswswnenesenenenw\nnwwsewwwnwwnewnwwnenwwseswnenwswwnw\nnenwneseeewneeeeseneesweneenwsee\nseswseswseswnwnwswswseswsweseswswswswse\nswwswneswswswswswswneswsweswswswswwswsesw\nsenesewseseseeewseweseseseeseesese\nswnesenenenwneneneswnwnwne\nwsesewwenenwsesewneneseseseswsesese\nnewseswwwswwwnwswweswwewswwww\nnweneeneneeswnwwenenesweneseneene\nesweneenweeeeseweeeneeewew\nneswnweswswnenweseswswnesewswsenwsese\nnwnwnwnwnwwenwwwnwnw\nswswseseswswswswswswswswswsweswneswswnwsw\nneneswnenwnenenenenenwnenwne\nseeseseneseseswseseseseswsesesenwsesesese\nnwnenwnwseenwnewewswsewnwwswswnew\nwseesesweseseeneeenwseeeeeenee\nswwwsewesewnewnweenwswswwwwwsw\neeneseseeseseseseswseewse\neeeneseeeeeeswseeenewseeee\nswseswswsewenenwnwwnweswne\newwnenwswnwnenwnwnwnenenwnwenenenwnw\nneswswswswswnwswwswsewsw\nseseeseswswewsewsenwseseneewsewneee\nseswseswenwwnwswwswewnweseswnwnw\nsesesenesesesewswseseswneseswsesesesesese\nneneneneneseenenewneeneneswwnesenenew\nnweeewneenwswneneswnewne\nnwwewwswwwseswwswwne\nnwnenwnwnwnwsewnwnwwnwewnwnwnwnwwnwnw\nseneneneneenenwnewneneneswneenenwswnenese\nswseswnwseswswseseseswnwnewseswswswswswsesw\nnwnenenwnwnenwnenwnwseswneneenwnesenwne\nnenenesweeenenenenewne\neewneeeweeeeseeeneneewene\nswsweswswswswswswswswneswnwseswnwwseswsw\nwwswwwnwnwewseweswnwnesenwwwew\nseeneenenenesenenesweweenenenenwnene\nnewewseewnwwnwwwsewsenewswswe\nsweeseweseseeeseeenesesesenwese\nneswewwwseswwwswsww\nwewnwnwnwnwnwwwnwwswesenwnwenwsee\nseswsewsewseswswenenewseenwnwnwswse\nswswseswseswseswswswnwswswnwsenesesw\nnwnwsenenenwsewnenenenwsenwnesesenwnwnwnw\nswnenwwwwwseswwneewswswwwnesene\nseseseswswsesenesesesesesw\neneenwneenenenewswneswnesweee\nnwnwneswnenenwsenenenenenenenwnenewnene\nseswnewswswswnwswsenwwsweswswnwswesee\nswswswswswwswswswewswneswswseswswswneswnw\nswswswswswseseswsenwseneesesesesewwsese\nseneeesweeeeeeweeeee\nsenweseeeenweeeenwenwsweeswese\nswswneswseewswswnwswswwsenweswswswesw\newneeeeeneweeeeeeweseesesese\nnwseswseneeseeseesweeweseesesee\nneeneswnenenewnwnenwnenenenwswneenewne\neswwswswnwnwseeenwweswnwnenwswswse\nwwswnewwswnwwwswwneneeswwseswne\nneneneneseneneswneneeneeewne\nwwwnwwnewsenweseewwwewwnew\nneswwsweewneswsenewsesewwsenwsesese\nseswwsweenwweseneseneseneeenwwe\nsenwsesweseseswnwseeseswsenesesenenewsw\nswseswswswswnenwswswwswswswswswwswenesw\nnesenwnwnwnenwnwnwnenwnewnwnwnwnwnesenw\nseswswswwswswwswswswswneswswenewnwswsw\nnwnwwnwnwnwnenwenwwwenwswwswnwnwnwnww\nneseenesenwnwsenwwneesewnewwswenwnenw\nwnenwnwnenenenwnenesenwnenenwnenwnenwe\nnwnwnwnwnenwnwnesenwnenwnwnenewnwnenwswe\nenwswseeseseseewseeswnweeseeeee\neeeeeesenwseseeee\nswsesweweswwswswswswnwnwwswswsw\nneseneneeeenwweneenenenene\nswwsenwnenenwnesesewneeswwswseswnwswswse\nseeenweesesweseeeweeeseeswnw\nsewsesesesesenesweesenwswsesw\nnwnenwwnwnwswnwnenwnwwnwnenwnwnwnwsenwe\nneenenwneeneswnenwneswneeneeneeneene\nseseeeweseseeeeseese\nnenwnenwnenenenenwswneneneenwnenenenw\nwwwwswswwsweswnewwnewsewwwne\nwwnenwnwsewnwnenwsenwnwnwnwnwwwnwnwsw\nseseseswswsesenwwsenesesesesesesene\nnwseswsesenwwswnenesenenwsw\nswswsweswswswseweswnwswswneseswswswnwsw\nenweesweneeneeneneeeeeneeewe\nseswseseseseswsesewseseseswswsenwesese\nseswsesesesenwnewsesesesesesesesesesenwsese\nswswswnwswswswseswnweswswswsw\nnewnwwswwneeneneseeneswnenenenwnenwnw\nswwswnwwswswnwswwewnwsweswswswseesw\nsweswnwswenwwswswwwwsweswswswswswsw\nnenenwnwsenesenenwnwnwnenenenenenwnwswnwne\nwnwseswwewwnewwswnwnwwswewsesww\nseseneseseswsesewswsesesesene\nwwnwwwewwwewwwnwwwwwnwsww\nwneeneesenwseeeeeweeesweswene\nsenesenwsweseeseesewseseenesewwsee\nnwnwnwsenwnwswesenwenwnwnwnwnwnwnwswnwnwnw\neeweeeeeesweneeeseeneeneee\nwwsenweswsewswneswswnweneswneenww\neeneneneeneeeeenewswneneeseenee\nswwseseneswseseweseseswneesenesesese\neeeeneneneneneweeee\nswsenesewseswsenwnenwsesweswsenwswswswnw\nnwnwswsweswnenwnwnwnenenwnwnwnwnwsenenw\nswsesweseseseweseeseswnwsesesenwseswsesw\neneeseneswswsweeweewnewne\nneneeseenenenewenenenewnenenwswesw\nsweeswwewsweewnwenwnwnesesenwesw\nswswswswswswneswswswsw\neseseeneeeseewenwweeeeswsesese\nswswwnwswnwwwswewweswwwwswswwe\nwwewswwnwwwwwswwwwwweww\nenenwnwwnwwwwsesese\nwwwwnwswwwswswwwewwwew\nwnenwneeswneneneseneewsw\nsweswnenenwewsesenwsenw\nwsewwenwnwnwwwnwwwnwnwwwnwww\neseeeeeeseeeseneeneeewwwee\nnwwnwewsewnenenwwnwswwnwwwswnwse\nwwswwwwweswwswwswswewwwneww\nswnewnwnwnewseswewnesweswswesesw\nnwnwnwswnwnenwnwnwnwnwnwewnwenwnwnwnw\nswseweswnesewneesenwnesenwwseesew\nwenweseesenwseswsesweswnenwneenwse\nseeneneneeeenweneene\nnwnwnenwneenwneswnenwnwnwnwswnwnwnwnwnw\nesesesweswneneneswnwnwnenwneneseww\nnwnwwenwnwnenwnenweswwenwnwnwnwnenesw\nsenewsewswswseseneswseseseseswsesesese\nnwnwnwsesenenwneneswnwnwewnesewnenese\nneesesewseseneseseseeseeseseesewsese\nswnewneswwswswwwnewsesesenwswswnwsew\nneseseswswwseseeswsesesesesesewseswse\nswsweswseswswneseeswswswnwnwswwwswneswnw\nseeeeseswsesesesesenwsesesee\nnenenwnwnwnwnwswsenwnwnwne\neswsweswswsweswseswswwnewswwswswswsw\nseneswneswswseswswseswswseswswsenenwswswsw\neswswseswnwnwsesewseseswseneeswswnesww\nseseseesesenwsesesenesewseseseseseesesew\nswswswswnweswswnewswswswswswwneswwswsw\nneeswnenenesweeneneeneneeneenenewne\nneswwswnwnwnwwseseneneewwsesewsew\neseseswwwseenesenesesenenwwnwseseswee\nswswswseseseseswwswneeswswweswnwsesene\nneneneneenesenwwweneswnwswwnwswnenwne\nneeeneeeseeneswnenenenenwewnee\nnwwnwewsenwnwnwenwesenwneewwnwsw\nseswewnwwnwwswnwsenwnwswseenesweene\nseswseneseswswseseseweesewwswwnesw\nneseeneneneswneeneenenenewneneneenw\nnwnwsewnwsenesenwwnewenw\nsenwneneswewnenenesenenenwewwnene\nnenwenwwswwwwwwwwwewwwwse\nsesenwsesesenwseesesenwnwswswsenewese\neeenenenwnwsweeeeeeeeeeneneswe\nswwwseswwseswswwswwneswswwwnwsww\nnwnwwnwwnwnesewnenwnwwwwnenwwwesese\nseswswnwswseseseswseswneseseseewswsese\nseswswneewneneeswswnwswwwswswnweswse\nnwnwnwnwwnwsenwnewnwnwnwneenenenwnwnesw\nnenwnwnwnwwnwesenwnwnwnwnwsewwnw\nneswwnesenwneswwenwnwsenwnweeswsese\nwwnwnwsewnenwwswwnwwwnwwnwnwwew\nsewswseseneswseseswswneswseneseseswsesw\nswwwnwwwswwswwwwwsewwwnwesww\nseneswswwswwnwenwnwwswseeswwwwwwsw\nneneswneneswnenesenenenewnenwneneneenw\nnwswseseneseseswswswnewswseseseweswnesenw\nnenenenenwneseneeneneneneneeswnenenwnee\nswseneeeeeeeweneswneweeswwnw\nnenenwneeneswneseenewnwswwnwenenenw\nsenenwnwwnwsewsewnesenenwwnewsewww\nswweeenenenenewseeeeewsenwnee\nnwneeseseseseseseseseseswse\neeeeweeeeweeneeesweneee\nswswseseesesesesesewseseseseneswsewnesesw\neeenwseeeswnweeeeeeeeeeeesw\nswswswswsweewswswswwsweswseswswnwnww\nsesewsenwseeseeseeeenwnweswnesesesw\nseseesesesesewseseeswseeseneesesenw\nneeenwnenwsweneneseeenee\nseenewesenwseseeseseseseee\nnwswswsweswswwwwwswswswwswsw\nwwwwnewwswnewwwnewwseswseww\neeseseseseseseseseesesesesenwenw\nwwewwwwwwwnwwwww\nswswswwswnewswneswswseswwswswwwswsw\nwswneswswswwwwneswwseswswwswwswswsesw\nnwnenwnenwnenenenewneneneseenwsenwswnwne\nwnweswenwneeswswweseneseneeeenw\nwnwneneneenenwnenenenene\nnewswwswweeswseseswswwseneswwnew\nwsweneeseseseseseseseeseeseseeswene\nsesenwseswseseseswseewnwseseswsese\nseswnwnwneesenwseneewswnenwee\nnwnwnwnwsenwnwnesewwnenenenenenwnenwnwnenw\nsenewesweeneswewsenwe\nsewewswswwwwswnwwwnewwwwwswsww\neeneeeeeneeseneeeneneneeswnwnw\nswseswwsewswseseswswseneswswswseseswneswsw\nnenenenwneneseneneneneneneeeeneneswnwne\nwnwsenwnwnwwsewnwnwnwnwnwewswnenenw\nnweeeeeneesweneeeeneeneeswesw\nsesewwnewwwwwnwwwnewwseeww\nnwswswnwswneswwwnwswswsweeswnweeneee\nwwwwwwwwswwwwwsewwnenewww\nnenwsenwseeswneswseseswswenwswswseswsww\nswswwswnwswwswswwswswwswwwewwnwew\nwnwnwnwnewseswwewnwwwnwnwwnwsew\nweseeseseseenenewseesewswsesesese\nnenenenwnwneswnwneneseneneenwnenwnenew\nnwseeeeswnewsewseeeeesesewesee\nwwnwwewwwwnwenwnwwwwswnwwww\nnwnwnwswnwnwnwenwnwnwnwnwnwnenwnwnwnw\nwseswweseseneswnwneseswsewswswseese\nneewseeesweeneenee\nenwseswswswseseswswswswwswswsenwnwe\nsewwnwwewwsewwwwwenwsewwwne\nwewswswwnwnenwswneeswnwnesesenwesw\nswswnenwneswswswswswswswswwswseneswswswse\nwswwswswwswneweswewnwswswwsewwe\nwnwwnwwsewswwwwwsenwwwswnenwswnee\nseseeswenenesesewsewswneneseseesenwse\nsesesesesesesenweneseseseseneswsewswsese\nwnwnenenesweneeweneseeeseeene\nsewnwwnwnwwnwwwwnwnwwsenwneww\nwwswswwnewneseswnewwsenewswwwsew\nnenesewneswnwenwwnesw\nnweeeeeeseeesenwneswneeweene\nnwnwwnwnwnwwnwnwwnwnwwwwew\nseseseseseseseseswsenwseswsesesenesesese\nseeswnwswnwnwseswsenesesweswse\nseseeseseseseeseseenwsewseseswnenesewse\nwweswnwwwnwsewwnwnwwnewnwwnwnwenw\nneneswswswswswswwswneeswwswseseswswswse\nsewnwseseswnwswseswsesenwseswseneseseswe\nseseseseseeneseewseswneseeseseseseese\newswseswnewswwwswwwswewwnew\nswwewwswnesenesenwwnewnw\nseseneseswsesenwseseswwnesesesewse\nnewswwswwswswswwswwnewswswswwsesw\nwseneeeeswnwneenweneneweeeeeee\nwswsewswswneswsewneneneswwwwswwsw\nswwneeneswswwwswwwsenwswwneswnene\nseeeeneeeeeswenweeeseseswsese\nsesweeenwnewnwnwneeenwswsewsenwsw\nseswnwseeseewnwswneenwnwseswneesee\nneswnwwnwnwswnwnwnwnwnwnwenwnwnwnwnwnw\nswseswswswseswswneswsw\nneeswneneeswsewnwnwneswewnenwenee\nswswseswswseswseswnwseswswweswswswneswswse\nseseewseeseeeswseseseneseeewee\neeeeeseeweswwseene\nswswswswswswswswswswseewneswswswswswsw\nsenwwwnewseesesenwnwenwwswnwnenwnwnw\neeeseswneesweeeeenweeeenee\nnewswnesweneneweneneneene\nnesenwnenenwnwswseswenwwwwsww\nsenewswswwseswswnwwsw\nnewwwwsewswwwwswnwsewswsw\nnwnwwnwnwsenwnwwnwnwnwnwnenwnwwwenw\nswsenwnesesesewswswswswswswswswseswswsw\nseneseseswwesewseseneseseeese\nwwwsewwwwnwnwswwwwwwwewwsw\nneewneeswenenenenenenenenenenewnenew\nnwnenwenwnwnwnwwnwnwnwnenewnwneenene\nenwwwwwwwwwsenwnwwewww\nsenwnwnwnwnwenenwwswneenesweewswswne\nnesesesesewsewnesenwseswseswsenwsesesw\nseseswswswseseenwseseneswnwnw\nseseseseseseeeseeweeseseswnwsenesenw\nnenewwswseseswseenwenesenwwwesenwswse\nnwnwnwnwswwnweswenwnwnwnwnwnwnwenwswnw\nwwwenwsesewnwnwnenwsenewsenwenwwse\nswsewswnwwwswewnw\nenwnwsenwnwenwnenwnwnwnwnwwswnwnwwew")

(def t "sesenwnenenewseeswwswswwnenewsewsw\nneeenesenwnwwswnenewnwwsewnenwseswesw\nseswneswswsenwwnwse\nnwnwneseeswswnenewneswwnewseswneseene\nswweswneswnenwsewnwneneseenw\neesenwseswswnenwswnwnwsewwnwsene\nsewnenenenesenwsewnenwwwse\nwenwwweseeeweswwwnwwe\nwsweesenenewnwwnwsenewsenwwsesesenwne\nneeswseenwwswnwswswnw\nnenwswwsewswnenenewsenwsenwnesesenew\nenewnwewneswsewnwswenweswnenwsenwsw\nsweneswneswneneenwnewenewwneswswnese\nswwesenesewenwneswnwwneseswwne\nenesenwswwswneneswsenwnewswseenwsese\nwnwnesenesenenwwnenwsewesewsesesew\nnenewswnwewswnenesenwnesewesw\neneswnwswnwsenenwnwnwwseeswneewsenese\nneswnwewnwnwseenwseesewsenwsweewe\nwseweeenwnesenwwwswnew")

(defn neighbor-at [coord [dir & more]]
  (let [[x y] coord
        is-even-row (even? y)
        move #(mapv + coord %)]
    (if dir
      (recur (move
               (case dir
                 "e" [1 0]
                 "w" [-1 0]
                 "nw" (if is-even-row [0 1] [-1 1])
                 "ne" (if is-even-row [1 1] [0 1])
                 "sw" (if is-even-row [0 -1] [-1 -1])
                 "se" (if is-even-row [1 -1] [0 -1])))
             more)
      coord)))

(defn toggle-at [coords dirs]
  (let [coord (neighbor-at [0 0] dirs)]
    (update coords coord (fnil #(if (#{:white} %) :black :white)
                               :white))))

(defn neighbors [coords coord]
  (->> ["e" "w" "nw" "ne" "sw" "se"]
       (map list)
       (map #(get coords (neighbor-at coord %) :white))))

(defn grid-coords [colors]
  (let [coords (keys colors)
        xs (map first coords)
        ys (map second coords)
        [min-x min-y] (map #(apply min %) [xs ys])
        [max-x max-y] (map #(apply max %) [xs ys])]
    (for [x (range (dec min-x) (+ 2 max-x))
          y (range (dec min-y) (+ 2 max-y))]
      [x y])))


(defn round [coords]
  (reduce (fn [acc coord]
            (let [t (get coords coord :white)
                  ns (neighbors coords coord)
                  num-black (count (filter #{:black} ns))]
              (cond
                (and (= t :black)
                     (or (zero? num-black)
                         (> num-black 2)))
                (assoc acc coord :white)

                (and (= t :white)
                     (= num-black 2))
                (assoc acc coord :black)

                :else acc)))
          coords
          (grid-coords coords)))

(defn num-black [tiles]
  (->> tiles vals (filter #{:black}) count))

;; A
(comment (->> input
              (->dirs)
              (reduce toggle-at {})
              (num-black)))

;; B
(comment (->> input
              (->dirs)
              (reduce toggle-at {})
              (iterate round)
              (drop 100)
              (first)
              (vals)
              (filter #{:black})
              (count)))
